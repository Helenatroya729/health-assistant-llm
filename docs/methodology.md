# Методология

Проект направлен на адаптацию большой языковой модели LLaMA 3.1 для обработки медицинских текстов и генерации персонализированных рекомендаций на основе генетического анализа. Работа включает несколько ключевых этапов, которые обеспечивают достижение поставленной цели: создание цифрового ассистента по здоровью, способного выдавать точные и релевантные рекомендации. Все этапы выполнены с учётом ограничений NDA, поэтому исходные данные и модели не публикуются.

Основные этапы работы:

1. **Подготовка данных**: Проведена обработка медицинского датасета, включающего генетические профили и рекомендации. Данные были очищены от невалидных символов, нормализованы с использованием морфологического анализа (pymorphy2) и структурированы в форматы вопрос-ответ (QA) и текстовые рекомендации (TXT). Подробности этапа описаны в [Подготовка данных](data_preparation.md).

2. **Генерация синтетических данных**: Для увеличения объёма обучающей выборки применялись методы перефразирования, синонимизации, изменения структуры предложений и суммаризации. Эти методы реализованы с использованием LLaMA 3.1 через Ollama и дополнительных скриптов обработки текста. Дедупликация обеспечивала уникальность записей. Подробности этапа описаны в [Генерация синтетических данных](synthetic_data.md).

3. **Дообучение модели**: LLaMA 3.1 была адаптирована с использованием LoRA-адаптера для эффективного дообучения на медицинских текстах. Обучение проводилось на 15 эпохах с learning_rate=1e-4, что позволило достичь среднего Train Loss 0.245. Подробности этапа описаны в [Дообучение модели](model_training.md).

4. **Оценка качества**: Качество модели оценивалось на обучающей выборке (Train Loss: 0.245). Для оценки генерации рекомендаций использовались метрики BLEU (0.83) и ROUGE-L (0.88), которые подтвердили высокую точность и релевантность сгенерированных текстов. Подробности этапа описаны в [Результаты](results.md).

Методология позволила адаптировать модель к специфике медицинского контента, обеспечив её способность генерировать точные рекомендации. Из-за NDA данные и модели не публикуются, но результаты представлены в виде метрик и синтетических примеров.